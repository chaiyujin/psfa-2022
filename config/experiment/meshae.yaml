# @package _global_

defaults:
  - /flame@model.decoder.morphable.flame: base_flame
  - override /model: meshae.yaml
  - override /dataset: talk_voca.yaml
  - override /datamodule: talk_voca.yaml

# all parameters below will be merged with parameters from default configurations set above
# this allows you to overwrite only specified parameters

path:
  exp_dir: ${path.runs_dir}/face_noeyeballs/meshae

trainer:
  max_epochs: 100
  check_val_every_n_epoch : 1
  progress_bar_refresh_rate: 10

# -------------------------------------------------------------------------------------------------------------------- #
#                                                         model                                                        #
# -------------------------------------------------------------------------------------------------------------------- #

callbacks:
  custom_callback:
    _target_: src.projects.anim.callback.PL_AnimCallback

  model_checkpoint:
    monitor: "epoch-val_loss/mesh:pos"
    mode: "min"
    save_top_k: 1
    save_every_n_epochs: 5

model:
  wanna_fps: 30
  debug: ${debug}

  data_info:
    src_seq_frames: 1
    tgt_seq_frames: 1
    src_seq_pads: [0, 0]
    pad_tgt: false

  optim:
    lr: 1e-4
    weight_decay: 1e-8
    lr_scheduler: { interval: epoch, gamma: 0.95, start_iter: 20, min_times: 0.1 }

# -------------------------------------------------------------------------------------------------------------------- #
#                                                       datamodel                                                      #
# -------------------------------------------------------------------------------------------------------------------- #

dataset:
  random_shift_alpha: 0.05
  speakers_voca: ${data.VOCASET.REAL3D_SPEAKERS}

datamodule:
  batch_size: 64
  batch_size_coma: ${.batch_size}
  num_workers: 4
